# Generated by Anaconda 34.25.5.9
# Generated by pykickstart v3.32
#version=RHEL9
# Use graphical install
graphical
repo --name="minimal" --baseurl=file:///run/install/sources/mount-0000-cdrom/minimal

%addon com_redhat_kdump --enable --reserve-mb='auto'

%end

# Keyboard layouts
keyboard --xlayouts='jp'
# System language
lang ja_JP.UTF-8

# Network information
network  --bootproto=dhcp --device=eth0 --ipv6=auto --activate

# Use CDROM installation media
cdrom

%packages
@^minimal-environment

%end

# Run the Setup Agent on first boot
firstboot --enable

# Generated using Blivet version 3.6.0
ignoredisk --only-use=sda
autopart
# Partition clearing information
clearpart --none --initlabel

# System timezone
timezone Asia/Tokyo --utc

#Root password
rootpw --lock
user --groups=wheel --name=pipeline --gecos="pipeline" --uid=1000 --gid=1000 --password="clustercluster"

%post
echo "pipeline		ALL=(ALL)		NOPASSWD: ALL" >> /etc/sudores.d/pipeline
chmod 0440 /etc/sudores.d/pipeline
sed -i.bak "s/^.*requiretty/#Defaults requiretty/" /etc/sudoers

# change a url number if use after rocky9
dnf config-manager --add-repo https://pkgs.tailscale.com/stable/rhel/9/tailscale.repo
dnf install -y tailscale
systemctl enable --now tailscaled
%end

reboot
